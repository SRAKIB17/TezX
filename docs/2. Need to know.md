## Compatibility

- params (`:id`)
- wildcard (`/*path` or `/*`)
- optional params (`/:id?`)

### 1. Router

- not support directly wildcard and optional params. (use `basePath` ✅)

```ts
const account = new Router<CustomContext>({
  basePath: "/account/:role?",
});
```

### 2. Overwritten router (method)

- Method will overwrite → Descending (from parent to child) ✅
- not found Handler will overwrite → Descending (from parent to child) ✅

```ts
// ❌ Conflicting routes
// ❓ Will be overwritten by the last handler.
// Output: {name: "Jhon"}
app.get("/users/:id", handleUser);
app.get("/users/:name", handleByName); // Will execute be reached

// ✅ Solution: Use distinct paths
app.get("/users/id/:id", handleUser);
app.get("/users/name/:name", handleByName);
```

### 3. Matching Priority

Routes are matched with following priority order:

1. Static paths (`/users/list`)
2. Named parameters (`/users/:id`)
3. Wildcard parameters (`/users/*`)
4. Optional parameters (`/users/:id?`)

## **4. ⚠️ Critical Implementation Note**

**Sub-router groups require explicit rule declaration:**

Inside sub-router each group (middleware ) act as a independence middleware.
So, like parent(sub-router) again add middlewareRule same as parent(sub-router)

```typescript
// ✅ Correct Implementation
const userRouter = new Router();
userRouter.group("/users", { middlewareRule: "follow" }, (group) => {
  group.use(loggerMiddleware);
  group.get("/:id", getUser);
});

server.addRouter("/", { middlewareRule: "follow" }, userRouter);

// ❌ Incorrect Implementation
const userRouter = new Router();
server.addRouter("/", { middlewareRule: "follow" }, userRouter);

userRouter.group("/users", (group) => {
  // MiddlewareRule not set here - will not inherit parent rule
});
```

### **❌ Incorrect Approach**

Always attach the middleware rule before declaring the group.

```typescript
const userRouter = new Router();
server.addRouter("/", { middlewareRule: "follow" }, userRouter);

//❌ This won't work because it's declared after router addition
userRouter.group("", { middlewareRule: "follow" }, (group) => {
  group.use(function test(ctx, next) {
    console.log("inside user group");
    return next();
  });

  group.delete("/users/:id", async (ctx) => {
    return ctx.json({ message: `User ID ${ctx.req.params.id} Deleted` });
  });
});

// ✅ Correct Implementation
const userRouter = new Router();
userRouter.group("", { middlewareRule: "follow" }, (group) => {
  group.use(function test(ctx, next) {
    console.log("inside user group");
    return next();
  });

  group.delete("/users/:id", async (ctx) => {
    return ctx.json({ message: `User ID ${ctx.req.params.id} Deleted` });
  });
});
server.addRouter("/", { middlewareRule: "follow" }, userRouter);
```
