# ⚡ TezX – Application Initialization Guide

`TezX` is a **high-performance, middleware-driven server framework** designed for **Deno**, **Bun**, and **Node.js**. It provides first-class support for:

* Route handling & dynamic path matching
* Middleware chaining at global and route level
* Runtime-agnostic request lifecycle management

---

## 🚀 Quick Start (`server.ts`)

```ts
// server.ts
import { loadEnv } from "tezx/deno";
import { TezX } from "tezx/core";
import { CustomRouter } from "./router.ts"; // Your custom routes
import { logger } from "tezx/middleware";

// Load environment variables
await loadEnv();

// Initialize TezX app
const app = new TezX({
  routeRegistry: new CustomRouter(),        // Custom route tree
  debugMode: true,                          // Enable detailed debug logs
  onPathResolve: (path) => path             // Optional path normalization
                    .replace(/\/+$/, "")
                    .toLowerCase(),
});

// Register global middleware
app.use(logger);

// Start server (Deno example)
Deno.serve({ port: 5000 }, app.serve);
```

---

## 📁 Recommended Project Structure

```bash
project/
├── middlewares/
│   └── logger.ts
├── router.ts
├── server.ts
├── .env
└── src/
    └── handlers/
        └── home.ts
```

---

## ⚙ TezX Configuration (`TezXConfig`)

| Option          | Type                       | Description                                         |
| --------------- | -------------------------- | --------------------------------------------------- |
| `routeRegistry` | `Router`                   | Custom router implementing the `Router` interface   |
| `debugMode`     | `boolean`                  | Enable detailed middleware-level logging            |
| `onPathResolve` | `(path: string) => string` | Hook to normalize or rewrite incoming request paths |
| `basePath`      | `string`                   | Optional prefix for all routes (default `/`)        |
| `env`           | `Record<string, any>`      | Custom environment object available in each context |

---

## 🛡 Global Middleware Support

Middleware functions have access to the **context (`ctx`)** and **`next()`** callback:

```ts
import { Middleware } from "tezx";

export const loggerMiddleware: Middleware = async (ctx, next) => {
  console.log(`[${ctx.method}] ${ctx.pathname}`);
  await next();
};

// Register globally
app.use(loggerMiddleware);
```

---

## ➕ Route-Level Middleware

`TezX` supports **ALL-method middleware** for interceptors, guards, or path-specific logic:

```ts
app.when("ALL", "/admin/:section", adminAuthMiddleware);
```

---

## ❌ Custom 404 Handler

```ts
app.notFound((ctx) => ctx.status(404).text("🔍 Not Found"));
```

---

## 🛠 Custom Error Handling

```ts
app.onError((err, ctx) => {
  console.error("Unhandled error:", err.details);
  return ctx.status(500).text("🔥 Internal Server Error");
});
```

---

## 📦 Environment Variables (`.env`)

```bash
PORT=5000
APP_NAME=TezXApp
```

Access variables anywhere in your app:

```ts
const port = Deno.env.get("PORT");
```

---

## 🧪 Running the Server

```bash
# Standard run
deno run --allow-net --allow-read --allow-env server.ts

# Live reload during development
deno run --watch --allow-all server.ts
```

---

## 🧬 Runtime Compatibility

| Feature    | Deno       | Bun        | Node.js   |
| ---------- | ---------- | ---------- | --------- |
| `.serve()` | ✅ Native   | ✅ Native   | ✅ Adapter |
| Middleware | ✅ Yes      | ✅ Yes      | ✅ Yes     |
| WebSocket  | ✅ Built-in | ✅ Built-in | ➖ Custom  |

---

## 💡 Summary

| Feature      | Purpose                                        |
| ------------ | ---------------------------------------------- |
| `TezX`       | Main application & runtime-agnostic router     |
| `use()`      | Register global middleware                     |
| `when()`     | Register dynamic routes (including ALL-method) |
| `notFound()` | Custom 404 handler                             |
| `onError()`  | Global error handling                          |
| `serve()`    | Entry point for Deno, Bun, or Node.js servers  |

---
