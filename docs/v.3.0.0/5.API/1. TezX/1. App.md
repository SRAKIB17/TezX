
# ✅ `TezX` - Application Initialization

`TezX` is a high-performance, middleware-based server and router framework designed for **Deno**, **Bun**, and **Node.js** environments. It offers first-class support for route handling, request lifecycle hooks, and elegant middleware chaining — built for speed and flexibility.

---

## 🚀 Quick Start: `server.ts`

```ts
// server.ts
import { loadEnv } from "tezx/deno";
import { TezX } from "tezx/core";
import { CustomRouter } from "./router.ts"; // your custom route tree
import { logger } from "tezx/logger";

// Optional: Load environment variables
await loadEnv();

const app = new TezX({
  routeRegistry: new CustomRouter(),   // 🚦 Route tree definition
  debugMode: true,                     // 🐞 Enables detailed debugging logs
  onPathResolve: (path) => path.replace(/\/+$/, "").toLowerCase(), // Optional
});

// 🔌 Register global middleware (optional)
app.use(logger);

// 🌐 Start TezX on Deno
Deno.serve({ port: 5000 }, app.serve);
```

---

## 📦 Folder Structure Example

```bash
project/
├── middlewares/
│   └── logger.ts
├── router.ts
├── server.ts
├── .env
└── src/
    └── handlers/
        └── home.ts
```

---

## ⚙️ `TezXConfig` Options

| Option          | Type                       | Description                                                           |
| --------------- | -------------------------- | --------------------------------------------------------------------- |
| `routeRegistry` | `Router`                   | Custom route registry implementing `Router` interface                 |
| `debugMode`     | `boolean`                  | Enable middleware-level debug logging                                 |
| `onPathResolve` | `(path: string) => string` | Hook to normalize paths (e.g., trim trailing slashes, lowercase URLs) |
| `basePath`      | `string`                   | Optional base path for all routes (defaults to `/`)                   |
| `env`           | `Record<string, any>`      | Custom environment object passed into each context                    |

---

## 🛡 Global Middleware Support

`TezX` allows chaining global middleware using the `.use()` method (inherited from `Router`). Each middleware gets access to the context and `next()` function.

```ts
import { Middleware } from "tezx/types";

export const loggerMiddleware: Middleware = async (ctx, next) => {
  console.log(`[${ctx.method}] ${ctx.pathname}`);
  await next();
};
```

### Registering Global Middleware

```ts
app.use(loggerMiddleware);
```

---

## ➕ Route-Level Middleware (All Methods)

If you define a middleware-only route (without `.get()`, `.post()` etc.), `TezX` treats it as an `ALL` method handler — perfect for interceptors, guards, or prefix-based matching:

```ts
app.addRoute({
  method: "ALL", // Intercepts all methods (GET, POST, etc.)
  path: "/admin/:section",
  handler: adminAuthMiddleware,
});
```

---

## ❌ Custom 404 Handler

```ts
app.notFound((ctx) => ctx.status(404).text("🔍 Not Found"));
```

---

## 🛠 Custom Error Handler

```ts
app.onError((err, ctx) => {
  console.error("Unhandled error:", err.message);
  return ctx.status(500).text("🔥 Internal Server Error");
});
```

---

## 📦 Environment Variables (`.env`)

```bash
PORT=5000
APP_NAME=TezXApp
```

```ts
// Access anywhere
const port = Deno.env.get("PORT");
```

---

## 🧪 Running the Server

```bash
deno run --allow-net --allow-read --allow-env server.ts
```

or with live reload:

```bash
deno run --watch --allow-all server.ts
```

---

## 🧬 Runtime Compatibility

| Feature    | Deno       | Bun        | Node.js   |
| ---------- | ---------- | ---------- | --------- |
| `.serve()` | ✅ Native   | ✅ Native   | ✅ Adapter |
| Middleware | ✅ Yes      | ✅ Yes      | ✅ Yes     |
| WebSocket  | ✅ Built-in | ✅ Built-in | ➖ Custom  |

---

## 💡 Summary

| Feature      | Description                                       |
| ------------ | ------------------------------------------------- |
| `TezX`       | Main app handler & runtime-agnostic router        |
| `use()`      | Register global middleware                        |
| `addRoute()` | Register routes dynamically, including ALL method |
| `notFound()` | Custom 404 handler                                |
| `onError()`  | Global error handler                              |
| `serve()`    | Entry point for Deno/Bun/Node servers             |

---
