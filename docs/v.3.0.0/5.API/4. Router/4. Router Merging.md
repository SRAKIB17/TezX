
# 🔀 **Router Merging — TezX**

## 📘 Overview

**Router merging** enables seamless integration of multiple routers into a parent application, preserving route hierarchy and avoiding accidental collisions by design.

---

## 🧭 Terminology

| Term              | Meaning                                                     |
| ----------------- | ----------------------------------------------------------- |
| **Parent Router** | Your primary app instance (`TezX` or `Router`)              |
| **Sub-Router**    | A child router with its own routes and middleware           |
| **Merged Router** | The resulting router structure after `.use()` or `.merge()` |

---

## 📂 Pre-Merge Example

```bash
Parent Router:
├── /test
│   ├── GET → handler1
│   └── /1
│       ├── GET → handler2
```

---

## ➕ Adding a Sub-Router

```bash
Sub-Router:
├── /products
│   └── /2
│       ├── GET → handler3
```

---

## ✅ After Merge

```bash
Merged Router:
├── /test
│   ├── GET → handler1
│   └── /1
│       ├── GET → handler2
├── /products
│   └── /2
│       ├── GET → handler3
```

> ✅ All routes remain intact and merge **non-destructively**.

---

## 🧪 Code Example

```ts
import { TezX, Router } from "tezx";

// Parent router
const app = new TezX();
app.get("/test", (ctx) => ctx.text("Handler 1"));
app.get("/test/1", (ctx) => ctx.text("Handler 2"));

// Sub-router
const productRouter = new Router();
productRouter.get("/products/2", (ctx) => ctx.text("Handler 3"));

// Merge the routers
app.use("/", productRouter);
```

---

## 🧑‍💻 Best Practices

### 1. **Use Unique Prefixes**

Avoid route conflicts by assigning distinct prefixes:

```ts
const authRouter = new Router();
authRouter.get("/login", ...);
app.use("/auth", authRouter); // Routes like /auth/login
```

---

### 2. **Middleware Hygiene**

Each sub-router can register its own middleware chain:

```ts
const api = new Router();

api.use((ctx, next) => {
  ctx.setHeader("x-api", "v1");
  return next();
});

api.get("/status", (ctx) => ctx.json({ ok: true }));

app.use("/api", api);
```

---

### 3. **Inspect Route Tree**

Use dev logs to inspect routes:

```ts
console.log(app.routes); // Tree-style structure if exposed
```

---

### 4. **Safe Re-Merge Patterns**

Avoid defining the same path in multiple routers unless intended.

```ts
// Avoid this
router1.get("/ping", ...);
router2.get("/ping", ...);

// Instead, use a prefix
app.use("/api", router1);
app.use("/public", router2);
```

---

## 🔍 Debug Tip

```ts
app.get("/example", (ctx) => {
  console.log("Routing to /example");
  return ctx.text("Logged");
});
```
