
---

# `loadEnv(basePath?: string)`

**Purpose:** Load `.env` files into `process.env` (Node/Bun) or `Deno.env` and get a **typed object** for safe access.

**Supported `.env` Files (Priority):**

```bash
.env → .env.local → .env.[mode] → .env.[mode].local
```

**Return Type:**

```ts
type EnvVariables = {
  [key: string]: string;
  NODE_ENV: "development" | "production" | "test";
};
```

**Usage:**

```ts
import { loadEnv } from "tezx/node"; // or "tezx/bun", "tezx/deno"

const env = loadEnv("./config");
const port = env.PORT || process.env.PORT || "3000";
```

---

# Custom Context

**Purpose:** Extend TezX’s `Context` with your own properties (e.g., user info, request metadata).

**Example:**

```ts
interface CustomContext {
  user?: { id: string; roles: string[] };
  requestId: string;
}

app.use(async (ctx, next) => {
  ctx.requestId = crypto.randomUUID();
  ctx.user = await authenticate(ctx.headers.get("Authorization"));
  return next();
});

app.get("/me", (ctx) => ctx.json(ctx.user));
```

---

# Server Initialization with Env & Custom Context

```ts
const env = loadEnv();

const app = new TezX<CustomContext>({ env });

app.use((ctx) => {
  if (ctx.env.API_KEY !== "expected") return ctx.status(401).text("Unauthorized");
});
```

**Options Table:**

| Option | Type           | Description                    |
| ------ | -------------- | ------------------------------ |
| `env`  | `EnvVariables` | Injected environment variables |

Access via `ctx.env` safely in middleware/routes.

---

# Best Practices

* **.env per mode:**

```bash
.env.development
.env.production
.env.production.local
```

* **Git ignore sensitive files:**

```bash
.env.local
.env.*.local
```

* **Feature flags:**

```ts
if (env.FEATURE_X === "enabled") enableExperimentalFeature();
```

---

# Advanced Context Usage

```ts
interface AppContext {
  user?: User;
  analytics: Tracker;
}

app.use((ctx, next) => {
  ctx.analytics = new Tracker(ctx.env.TRACKING_ID);
  return next();
});
```

---
