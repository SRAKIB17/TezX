### **Node.js Configuration with TezX**

### **Running the Server**

1. Install `TezX`:

```bash
npm install TezX
```

2. Save the code in a file (e.g., `index.js`).

3. Run:

```bash
node index.js
```

4. Test endpoints like `http://localhost:3001/products`.

### **Example**

```javascript
// Import necessary modules from TezX
import { loadEnv, logger, nodeAdapter, Router, TezX } from "TezX";

// Load environment variables (e.g., from a .env file)
const env = loadEnv();

// Initialize the TezX application with configuration
const app = new TezX({
  logger: logger, // Built-in logger for request/response logging
  env: env, // Environment variables for configuration
  allowDuplicateMw: true, // Allows duplicate middleware registration
});

// **Product Routes**

// Initialize a new Router instance for product-related routes
const productRouter = new Router({});

// Group product routes with shared middleware
productRouter.group("", (group) => {
  // Middleware applied to all routes in this group
  group.use((ctx, next) => {
    console.log("inside router"); // Log for debugging
    return next(); // Proceed to next middleware/handler
  });

  // GET /products - Returns an empty JSON object
  group.get("/products", async (ctx) => {
    return ctx.json({});
  });
});

// GET /products/:id - Fetch product by ID
productRouter.get("/products/:id", async (ctx) => {
  return ctx.json({ message: `Product ID: ${ctx.req.params.id}` });
});

// POST /products - Create a new product
productRouter.post("/products", async (ctx) => {
  const productData = await ctx.req.json(); // Parse request body
  return ctx.json({ message: "Product Created", data: productData });
});

// PUT /products/:id - Update a product by ID
productRouter.put("/products/:id", async (ctx) => {
  return ctx.json({ message: `Product ID ${ctx.req.params.id} Updated` });
});

// DELETE /products/:id - Delete a product by ID
productRouter.delete("/products/:id", async (ctx) => {
  return ctx.json({ message: `Product ID ${ctx.req.params.id} Deleted` });
});

// Mount the productRouter at the root path "/"
app.use("/", productRouter);

// Start the server using the Node.js adapter
nodeAdapter(app).listen(3001, () => {
  console.log("Server running on port 3001");
});
```

### **Sample Requests**

| Method | Path            | Response                                        |
| ------ | --------------- | ----------------------------------------------- |
| GET    | `/products`     | `{}`                                            |
| GET    | `/products/123` | `{"message": "Product ID: 123"}`                |
| POST   | `/products`     | `{"message": "Product Created", "data": {...}}` |
| PUT    | `/products/123` | `{"message": "Product ID 123 Updated"}`         |
| DELETE | `/products/123` | `{"message": "Product ID 123 Deleted"}`         |

---

### **Key Notes**

- The `allowDuplicateMw: true` setting still allows duplicate middleware within the `productRouter` group if added multiple times.
- The middleware `console.log("inside router")` applies to all routes in the group (e.g., `/products`).
- The server runs on port `3001` as before.

---
